

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>docx2python package &mdash; source 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> source
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">docx2python package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-docx2python.depth_collector">docx2python.depth_collector module</a></li>
<li><a class="reference internal" href="#module-docx2python.docx_context">docx2python.docx_context module</a></li>
<li><a class="reference internal" href="#module-docx2python.docx_output">docx2python.docx_output module</a></li>
<li><a class="reference internal" href="#module-docx2python.docx_text">docx2python.docx_text module</a></li>
<li><a class="reference internal" href="#module-docx2python.iterators">docx2python.iterators module</a></li>
<li><a class="reference internal" href="#module-docx2python.main">docx2python.main module</a></li>
<li><a class="reference internal" href="#module-docx2python.namespace">docx2python.namespace module</a></li>
<li><a class="reference internal" href="#module-docx2python.numbering_formats">docx2python.numbering_formats module</a></li>
<li><a class="reference internal" href="#module-docx2python.text_runs">docx2python.text_runs module</a></li>
<li><a class="reference internal" href="#module-docx2python">Module contents</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">source</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>docx2python package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/docx2python.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="docx2python-package">
<h1>docx2python package<a class="headerlink" href="#docx2python-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-docx2python.depth_collector">
<span id="docx2python-depth-collector-module"></span><h2>docx2python.depth_collector module<a class="headerlink" href="#module-docx2python.depth_collector" title="Permalink to this headline">¶</a></h2>
<p>Collect xml text in a nested list</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>6/26/2019</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>  <span class="c1"># tables</span>
    <span class="p">[</span>  <span class="c1"># table</span>
        <span class="p">[</span>  <span class="c1"># row</span>
            <span class="p">[</span>  <span class="c1"># cell</span>
                <span class="p">[</span>  <span class="c1"># paragraph</span>
                    <span class="s2">&quot;&quot;</span>  <span class="c1"># text run</span>
                <span class="p">]</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Text in table cells and text outside of a table must be captured at depth=5. To keep
track of this, these few methods will put text where it needs to be.</p>
<p>The package will recursively descend into elements in the docx file, so the point at
which a table, row, cell, paragraph, or text run begins and ends is known. Drop and
raise the caret when these items are opened or closed in the xml. Insert text when
found.</p>
<p>Shorthand for this package. Instances of this class should not escape the package.
Pass out of package with depth_collector_instance.tree.</p>
<dl class="exception">
<dt id="docx2python.depth_collector.CaretDepthError">
<em class="property">exception </em><code class="sig-prename descclassname">docx2python.depth_collector.</code><code class="sig-name descname">CaretDepthError</code><a class="headerlink" href="#docx2python.depth_collector.CaretDepthError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="docx2python.depth_collector.DepthCollector">
<em class="property">class </em><code class="sig-prename descclassname">docx2python.depth_collector.</code><code class="sig-name descname">DepthCollector</code><span class="sig-paren">(</span><em class="sig-param">item_depth: int</em><span class="sig-paren">)</span><a class="headerlink" href="#docx2python.depth_collector.DepthCollector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Insert items into a tree at a consistent depth.</p>
<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.caret">
<em class="property">property </em><code class="sig-name descname">caret</code><a class="headerlink" href="#docx2python.depth_collector.DepthCollector.caret" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowest open child.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.drop_caret">
<code class="sig-name descname">drop_caret</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#docx2python.depth_collector.DepthCollector.drop_caret" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new branch under caret.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.insert">
<code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">item: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#docx2python.depth_collector.DepthCollector.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Add item at item_depth. Add branches if necessary to reach depth.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.raise_caret">
<code class="sig-name descname">raise_caret</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#docx2python.depth_collector.DepthCollector.raise_caret" title="Permalink to this definition">¶</a></dt>
<dd><p>Close branch at caret and move up to parent.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.set_caret">
<code class="sig-name descname">set_caret</code><span class="sig-paren">(</span><em class="sig-param">depth: int</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#docx2python.depth_collector.DepthCollector.set_caret" title="Permalink to this definition">¶</a></dt>
<dd><p>Set caret at given depth.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.depth_collector.DepthCollector.tree">
<em class="property">property </em><code class="sig-name descname">tree</code><a class="headerlink" href="#docx2python.depth_collector.DepthCollector.tree" title="Permalink to this definition">¶</a></dt>
<dd><p>All collected items.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-docx2python.docx_context">
<span id="docx2python-docx-context-module"></span><h2>docx2python.docx_context module<a class="headerlink" href="#module-docx2python.docx_context" title="Permalink to this headline">¶</a></h2>
<p>Content from files that aren’t <code class="docutils literal notranslate"><span class="pre">word/document.xml</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>6/26/2019</p>
</dd>
</dl>
<p>Most of the “meat” in a docx file is in <code class="docutils literal notranslate"><span class="pre">word/document.xml</span></code>. These functions retrieve
numbering formats, images, and font styles from <em>other</em> files in a decompressed docx.</p>
<p>Several functions here take a bytes-format document from a decompressed docx.file.
Create such with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>

<span class="n">zipf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;docx_filename.docx&quot;</span><span class="p">)</span>
<span class="n">xml</span> <span class="o">=</span> <span class="n">zipf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;trash/numbering.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="function">
<dt id="docx2python.docx_context.collect_docProps">
<code class="sig-prename descclassname">docx2python.docx_context.</code><code class="sig-name descname">collect_docProps</code><span class="sig-paren">(</span><em class="sig-param">xml: bytes</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="headerlink" href="#docx2python.docx_context.collect_docProps" title="Permalink to this definition">¶</a></dt>
<dd><p>Get author, modified, etc. from docProps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xml</strong> – <code class="docutils literal notranslate"><span class="pre">DocProps/core.xml</span></code> from a decompressed docx file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>document property names mapped to values</p>
</dd>
</dl>
<p><strong>E.g., Given</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">cp</span><span class="p">:</span><span class="n">coreProperties</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">cp</span><span class="o">=</span><span class="s2">&quot;http://schemas.openxmlformats...&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">dc</span><span class="p">:</span><span class="n">title</span><span class="o">&gt;</span><span class="n">SG</span><span class="o">-</span><span class="n">DOP</span><span class="o">-</span><span class="mi">5009</span> <span class="o">-</span> <span class="n">Operate</span> <span class="n">ROMAR</span> <span class="n">swarf</span> <span class="n">unit</span>
    <span class="o">&lt;/</span><span class="n">dc</span><span class="p">:</span><span class="n">title</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">dc</span><span class="p">:</span><span class="n">creator</span><span class="o">&gt;</span><span class="n">Shay</span> <span class="n">Hill</span>
    <span class="o">&lt;/</span><span class="n">dc</span><span class="p">:</span><span class="n">creator</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">cp</span><span class="p">:</span><span class="n">lastModifiedBy</span><span class="o">&gt;</span><span class="n">Shay</span> <span class="n">Hill</span>
    <span class="o">&lt;/</span><span class="n">cp</span><span class="p">:</span><span class="n">lastModifiedBy</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">cp</span><span class="p">:</span><span class="n">revision</span><span class="o">&gt;</span><span class="mi">6</span>
    <span class="o">&lt;/</span><span class="n">cp</span><span class="p">:</span><span class="n">revision</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">cp</span><span class="p">:</span><span class="n">lastPrinted</span><span class="o">&gt;</span><span class="mi">2017</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">17</span><span class="n">T15</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">00</span><span class="n">Z</span>
    <span class="o">&lt;/</span><span class="n">cp</span><span class="p">:</span><span class="n">lastPrinted</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">dcterms</span><span class="p">:</span><span class="n">created</span> <span class="n">xsi</span><span class="p">:</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;dcterms:W3CDTF&quot;</span><span class="o">&gt;</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">10</span><span class="n">T07</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">00</span><span class="n">Z</span>
    <span class="o">&lt;/</span><span class="n">dcterms</span><span class="p">:</span><span class="n">created</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">dcterms</span><span class="p">:</span><span class="n">modified</span> <span class="n">xsi</span><span class="p">:</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;dcterms:W3CDTF&quot;</span><span class="o">&gt;</span><span class="mi">2019</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span><span class="n">T11</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">00</span><span class="n">Z</span>
    <span class="o">&lt;/</span><span class="n">dcterms</span><span class="p">:</span><span class="n">modified</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">cp</span><span class="p">:</span><span class="n">coreProperties</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>E.g., Returns</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;SG-DOP-5009 - Operate ROMAR swarf unit&quot;</span><span class="p">,</span>
    <span class="s2">&quot;creator&quot;</span><span class="p">:</span> <span class="s2">&quot;Shay Hill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastModifiedBy&quot;</span><span class="p">:</span> <span class="s2">&quot;Shay Hill&quot;</span><span class="p">,</span>
    <span class="s2">&quot;revision&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.docx_context.collect_image_rels">
<code class="sig-prename descclassname">docx2python.docx_context.</code><code class="sig-name descname">collect_image_rels</code><span class="sig-paren">(</span><em class="sig-param">xml: bytes</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="headerlink" href="#docx2python.docx_context.collect_image_rels" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect relId with images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xml</strong> – <code class="docutils literal notranslate"><span class="pre">word/_rels/document.xml.rels</span></code> from a decompressed docx file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">relId</span></code> mapped to <code class="docutils literal notranslate"><span class="pre">Target</span></code>.</p>
</dd>
</dl>
<p><strong>E.g, Given</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Relationships</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Relationship</span> <span class="n">Id</span><span class="o">=</span><span class="s2">&quot;rId8&quot;</span> <span class="n">Target</span><span class="o">=</span><span class="s2">&quot;webSettings.xml&quot;</span><span class="o">/&gt;</span>  <span class="c1"># ignore this one</span>
    <span class="o">&lt;</span><span class="n">Relationship</span> <span class="n">Id</span><span class="o">=</span><span class="s2">&quot;rId13&quot;</span> <span class="n">Target</span><span class="o">=</span><span class="s2">&quot;media/image5.jpeg&quot;</span><span class="o">/&gt;</span>  <span class="c1"># map Id to Target</span>
<span class="o">&lt;</span><span class="n">Relationships</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>E.g., Returns</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;rId13&quot;</span><span class="p">:</span> <span class="s2">&quot;image5.jpg&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.docx_context.collect_numFmts">
<code class="sig-prename descclassname">docx2python.docx_context.</code><code class="sig-name descname">collect_numFmts</code><span class="sig-paren">(</span><em class="sig-param">xml: bytes</em><span class="sig-paren">)</span> &#x2192; Dict[str, List[str]]<a class="headerlink" href="#docx2python.docx_context.collect_numFmts" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect abstractNum bullet formats into a dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xml</strong> – <code class="docutils literal notranslate"><span class="pre">trash/numbering.xml</span></code> from a decompressed docx file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numId mapped to numFmts (by ilvl)</p>
</dd>
<dt class="field-odd">Background</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">trash/numbering.xml</span></code> will have two sections.</p>
<p><strong>SECTION 1</strong> - Some abstractNum elements defining numbering formats for multiple
indentation levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">abstractNum</span> <span class="n">w</span><span class="p">:</span><span class="n">abstractNumId</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">lvl</span> <span class="n">w</span><span class="p">:</span><span class="n">ilvl</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">numFmt</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;decimal&quot;</span><span class="o">/&gt;&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">lvl</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">lvl</span> <span class="n">w</span><span class="p">:</span><span class="n">ilvl</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">numFmt</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;lowerLetter&quot;</span><span class="o">/&gt;&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">lvl</span><span class="o">&gt;</span>
    <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">abstractNum</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>SECTION 2</strong> - Some num elements, each referencing an abstractNum. Multiple nums
may reference the same abstractNum, but each will maintain a separate count (i.e.,
each numbered paragraph will start from 1, even if it shares a style with another
paragraph.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">num</span> <span class="n">w</span><span class="p">:</span><span class="n">numId</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">abstractNumId</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">num</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">num</span> <span class="n">w</span><span class="p">:</span><span class="n">numId</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">abstractNumId</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">num</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>E.g, Given</strong>: <em>above</em></p>
<p><strong>E.g., Returns</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;decimal&quot;</span><span class="p">,</span> <span class="s2">&quot;lowerLetter&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.docx_context.get_context">
<code class="sig-prename descclassname">docx2python.docx_context.</code><code class="sig-name descname">get_context</code><span class="sig-paren">(</span><em class="sig-param">zipf: zipfile.ZipFile</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="headerlink" href="#docx2python.docx_context.get_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect context information from docProps, rels etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zipf</strong> – created by <code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile(&quot;docx_filename&quot;)</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>dictionaries</p>
<ul class="simple">
<li><p>rId2Target - rel Id mapped to image files</p></li>
<li><p>docProp2text - document properties like ‘modified’ and ‘created’</p></li>
<li><p>numId2numFmts - paragraph IDs mapped to number and bullet formats</p></li>
<li><p>numIdcount - a counter starting at 0 for each ilvl of each numbered list</p></li>
</ul>
<p>The last two will only be present in documents with bulleted or numbered lists.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.docx_context.pull_image_files">
<code class="sig-prename descclassname">docx2python.docx_context.</code><code class="sig-name descname">pull_image_files</code><span class="sig-paren">(</span><em class="sig-param">zipf: zipfile.ZipFile</em>, <em class="sig-param">image_directory: Optional[str] = None</em><span class="sig-paren">)</span> &#x2192; Dict[str, bytes]<a class="headerlink" href="#docx2python.docx_context.pull_image_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy images from zip file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zipf</strong> – created by <code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile(docx_filename)</span></code></p></li>
<li><p><strong>image_directory</strong> – optional destination for copied images</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Image names mapped to images in binary format.</p>
<p>To write these to disc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-odd">Side effects</dt>
<dd class="field-odd"><p>Given an optional image_directory, will write the images out to file.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-docx2python.docx_output">
<span id="docx2python-docx-output-module"></span><h2>docx2python.docx_output module<a class="headerlink" href="#module-docx2python.docx_output" title="Permalink to this headline">¶</a></h2>
<p>Output format for extracted docx content.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>7/5/2019</p>
</dd>
</dl>
<dl class="class">
<dt id="docx2python.docx_output.DocxContent">
<em class="property">class </em><code class="sig-prename descclassname">docx2python.docx_output.</code><code class="sig-name descname">DocxContent</code><span class="sig-paren">(</span><em class="sig-param">*, header: List[List[List[List[str]]]], footer: List[List[List[List[str]]]], body: List[List[List[List[str]]]], properties: Dict[str, Any], images: Dict[str, bytes]</em><span class="sig-paren">)</span><a class="headerlink" href="#docx2python.docx_output.DocxContent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Holds return values for docx content.</p>
<dl class="method">
<dt id="docx2python.docx_output.DocxContent.document">
<em class="property">property </em><code class="sig-name descname">document</code><a class="headerlink" href="#docx2python.docx_output.DocxContent.document" title="Permalink to this definition">¶</a></dt>
<dd><p>All docx “tables” concatenated.</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.docx_output.DocxContent.text">
<em class="property">property </em><code class="sig-name descname">text</code><a class="headerlink" href="#docx2python.docx_output.DocxContent.text" title="Permalink to this definition">¶</a></dt>
<dd><p>All docx paragraphs, “</p>
<p>” delimited.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-docx2python.docx_text">
<span id="docx2python-docx-text-module"></span><h2>docx2python.docx_text module<a class="headerlink" href="#module-docx2python.docx_text" title="Permalink to this headline">¶</a></h2>
<p>Extract text from docx content files.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>6/6/2019</p>
</dd>
</dl>
<dl class="simple">
<dt>Content in the extracted docx is found in the <code class="docutils literal notranslate"><span class="pre">word</span></code> folder:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">word/document.html</span></code>
<code class="docutils literal notranslate"><span class="pre">word/header1.html</span></code>
<code class="docutils literal notranslate"><span class="pre">word/footer1.html</span></code></p>
</dd>
</dl>
<dl class="function">
<dt id="docx2python.docx_text.get_text">
<code class="sig-prename descclassname">docx2python.docx_text.</code><code class="sig-name descname">get_text</code><span class="sig-paren">(</span><em class="sig-param">xml: bytes, context: Dict[str, Any]</em><span class="sig-paren">)</span> &#x2192; List[List[List[List[str]]]]<a class="headerlink" href="#docx2python.docx_text.get_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Xml as a string to a list of cell strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml</strong> – an xml bytes object which might contain text</p></li>
<li><p><strong>context</strong> – dictionary of document attributes generated in get_docx_text</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A 4-deep nested list of strings.</p>
</dd>
</dl>
<p>Sorts the text into the DepthCollector instance, five-levels deep</p>
<p><code class="docutils literal notranslate"><span class="pre">[table][row][cell][paragraph][run]</span></code> is a string</p>
<p>Joins the runs before returning, so return list will be</p>
<p><code class="docutils literal notranslate"><span class="pre">[table][row][cell][paragraph]</span></code> is a string</p>
<p>If you’d like to extend or edit this package, this function is probably where you
want to do it. Nothing tricky here except keeping track of the text formatting.</p>
</dd></dl>

</div>
<div class="section" id="module-docx2python.iterators">
<span id="docx2python-iterators-module"></span><h2>docx2python.iterators module<a class="headerlink" href="#module-docx2python.iterators" title="Permalink to this headline">¶</a></h2>
<p>Iterate over extracted docx content.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>6/28/2019</p>
</dd>
</dl>
<p>This package extracts docx text as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>  <span class="c1"># tables</span>
    <span class="p">[</span>  <span class="c1"># table</span>
        <span class="p">[</span>  <span class="c1"># row</span>
            <span class="p">[</span>  <span class="c1"># cell</span>
                <span class="s2">&quot;&quot;</span>  <span class="c1"># paragraph</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>These functions help manipulate that deep nest without deep indentation.</p>
<dl class="class">
<dt id="docx2python.iterators.IndexedItem">
<em class="property">class </em><code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">IndexedItem</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#docx2python.iterators.IndexedItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="docx2python.iterators.IndexedItem.index">
<em class="property">property </em><code class="sig-name descname">index</code><a class="headerlink" href="#docx2python.iterators.IndexedItem.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="docx2python.iterators.IndexedItem.value">
<em class="property">property </em><code class="sig-name descname">value</code><a class="headerlink" href="#docx2python.iterators.IndexedItem.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.enum_at_depth">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">enum_at_depth</code><span class="sig-paren">(</span><em class="sig-param">nested: Sequence[Any], depth: int</em><span class="sig-paren">)</span> &#x2192; Iterator[docx2python.iterators.IndexedItem]<a class="headerlink" href="#docx2python.iterators.enum_at_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate over a nested sequence at depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nested</strong> – a (nested) sequence</p></li>
<li><p><strong>depth</strong> – <p>depth of iteration</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">((i,),</span> <span class="pre">nested[i])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">((i,</span> <span class="pre">j),</span> <span class="pre">nested[:][j])</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">((i,</span> <span class="pre">j,</span> <span class="pre">k),</span> <span class="pre">nested[:][:][k])</span></code></p></li>
<li><p>…</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuples (tuple “address”, item)</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]],</span> <span class="p">[[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">]]],</span>
<span class="gp">... </span>    <span class="p">[[[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">]]]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enum_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">IndexedItem(index=(0,), value=[[[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;]], [[&#39;d&#39;, &#39;e&#39;]]])</span>
<span class="go">IndexedItem(index=(1,), value=[[[&#39;f&#39;], [&#39;g&#39;, &#39;h&#39;]]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enum_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">IndexedItem(index=(0, 0), value=[[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;]])</span>
<span class="go">IndexedItem(index=(0, 1), value=[[&#39;d&#39;, &#39;e&#39;]])</span>
<span class="go">IndexedItem(index=(1, 0), value=[[&#39;f&#39;], [&#39;g&#39;, &#39;h&#39;]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enum_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">IndexedItem(index=(0, 0, 0), value=[&#39;a&#39;, &#39;b&#39;])</span>
<span class="go">IndexedItem(index=(0, 0, 1), value=[&#39;c&#39;])</span>
<span class="go">IndexedItem(index=(0, 1, 0), value=[&#39;d&#39;, &#39;e&#39;])</span>
<span class="go">IndexedItem(index=(1, 0, 0), value=[&#39;f&#39;])</span>
<span class="go">IndexedItem(index=(1, 0, 1), value=[&#39;g&#39;, &#39;h&#39;])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enum_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">IndexedItem(index=(0, 0, 0, 0), value=&#39;a&#39;)</span>
<span class="go">IndexedItem(index=(0, 0, 0, 1), value=&#39;b&#39;)</span>
<span class="go">IndexedItem(index=(0, 0, 1, 0), value=&#39;c&#39;)</span>
<span class="go">IndexedItem(index=(0, 1, 0, 0), value=&#39;d&#39;)</span>
<span class="go">IndexedItem(index=(0, 1, 0, 1), value=&#39;e&#39;)</span>
<span class="go">IndexedItem(index=(1, 0, 0, 0), value=&#39;f&#39;)</span>
<span class="go">IndexedItem(index=(1, 0, 1, 0), value=&#39;g&#39;)</span>
<span class="go">IndexedItem(index=(1, 0, 1, 1), value=&#39;h&#39;)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">enum_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">will not iterate over sequence item</span>
</pre></div>
</div>
<p>This error is analogous to the <code class="docutils literal notranslate"><span class="pre">TypeError:</span> <span class="pre">'int'</span> <span class="pre">object</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">iterable</span></code> you
would see if attempting to enumerate over a non-iterable. In this case,
you’ve attempted to enumerate over an item that <em>may</em> be iterable, but is not of
the same type as the <code class="docutils literal notranslate"><span class="pre">nested</span></code> sequence argument. This type checking is how we
can safely descend into a nested list of strings.</p>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.enum_cells">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">enum_cells</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[docx2python.iterators.IndexedItem]<a class="headerlink" href="#docx2python.iterators.enum_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate over <code class="docutils literal notranslate"><span class="pre">tables[:][:][k]</span></code></p>
<p>Analog of enum_at_depth(tables, 3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">0,</span> <span class="pre">0),</span> <span class="pre">tables[0][0][0])</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">((i,</span> <span class="pre">j,</span> <span class="pre">k),</span> <span class="pre">tables[i][j][k])</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.enum_paragraphs">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">enum_paragraphs</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[docx2python.iterators.IndexedItem]<a class="headerlink" href="#docx2python.iterators.enum_paragraphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate over <code class="docutils literal notranslate"><span class="pre">tables[:][:][:][l]</span></code></p>
<p>Analog of enum_at_depth(tables, 4)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0),</span> <span class="pre">tables[0][0][0][0])</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">((i,</span> <span class="pre">j,</span> <span class="pre">k,</span> <span class="pre">l),</span> <span class="pre">tables[i][j][k][l])</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.enum_rows">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">enum_rows</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[docx2python.iterators.IndexedItem]<a class="headerlink" href="#docx2python.iterators.enum_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate over <code class="docutils literal notranslate"><span class="pre">tables[:][j]</span></code></p>
<p>Analog of enum_at_depth(tables, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">0),</span> <span class="pre">tables[0][0])</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">((i,</span> <span class="pre">j),</span> <span class="pre">tables[i][j])</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.enum_tables">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">enum_tables</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[docx2python.iterators.IndexedItem]<a class="headerlink" href="#docx2python.iterators.enum_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate over <code class="docutils literal notranslate"><span class="pre">tables[i]</span></code></p>
<p>Analog of enum_at_depth(tables, 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">((0,</span> <span class="pre">),</span> <span class="pre">tables[0])</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">((i,</span> <span class="pre">),</span> <span class="pre">tables[i])</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.iter_at_depth">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">iter_at_depth</code><span class="sig-paren">(</span><em class="sig-param">nested: Sequence[Any], depth: int</em><span class="sig-paren">)</span> &#x2192; Iterator[Any]<a class="headerlink" href="#docx2python.iterators.iter_at_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over a nested sequence at depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nested</strong> – a (nested) sequence</p></li>
<li><p><strong>depth</strong> – <p>depth of iteration</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">nested[i]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">nested[:][j]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">nested[:][:][k]</span></code></p></li>
<li><p>…</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sub-sequences or items in nested</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">[[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]],</span> <span class="p">[[</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">]]],</span>
<span class="gp">... </span>    <span class="p">[[[</span><span class="s2">&quot;f&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">]]]</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iter_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;]], [[&#39;d&#39;, &#39;e&#39;]]]</span>
<span class="go">[[[&#39;f&#39;], [&#39;g&#39;, &#39;h&#39;]]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iter_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;]]</span>
<span class="go">[[&#39;d&#39;, &#39;e&#39;]]</span>
<span class="go">[[&#39;f&#39;], [&#39;g&#39;, &#39;h&#39;]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">iter_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;c&#39;]</span>
<span class="go">[&#39;d&#39;, &#39;e&#39;]</span>
<span class="go">[&#39;f&#39;]</span>
<span class="go">[&#39;g&#39;, &#39;h&#39;]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">iter_at_depth</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.iter_cells">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">iter_cells</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[List[Any]]<a class="headerlink" href="#docx2python.iterators.iter_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over <code class="docutils literal notranslate"><span class="pre">tables[:][:][k]</span></code></p>
<p>Analog of iter_at_depth(tables, 3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tables[0][0][0],</span> <span class="pre">tables[0][0][1],</span> <span class="pre">...</span> <span class="pre">tables[i][j][k]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.iter_paragraphs">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">iter_paragraphs</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[str]<a class="headerlink" href="#docx2python.iterators.iter_paragraphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over <code class="docutils literal notranslate"><span class="pre">tables[:][:][:][l]</span></code></p>
<p>Analog of iter_at_depth(tables, 4)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tables[0][0][0][0],</span> <span class="pre">tables[0][0][0][1],</span> <span class="pre">...</span> <span class="pre">tables[i][j][k][l]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.iter_rows">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">iter_rows</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[List[List[Any]]]<a class="headerlink" href="#docx2python.iterators.iter_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over <code class="docutils literal notranslate"><span class="pre">tables[:][j]</span></code></p>
<p>Analog of iter_at_depth(tables, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tables[0][0],</span> <span class="pre">tables[0][1],</span> <span class="pre">...</span> <span class="pre">tables[i][j]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.iterators.iter_tables">
<code class="sig-prename descclassname">docx2python.iterators.</code><code class="sig-name descname">iter_tables</code><span class="sig-paren">(</span><em class="sig-param">tables: Sequence[Sequence[Sequence[Sequence[Any]]]]</em><span class="sig-paren">)</span> &#x2192; Iterator[List[List[List[Any]]]]<a class="headerlink" href="#docx2python.iterators.iter_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over <code class="docutils literal notranslate"><span class="pre">tables[i]</span></code></p>
<p>Analog of iter_at_depth(tables, 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tables</strong> – <code class="docutils literal notranslate"><span class="pre">[[[[&quot;string&quot;]]]]</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tables[0],</span> <span class="pre">tables[1],</span> <span class="pre">...</span> <span class="pre">tables[i]</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-docx2python.main">
<span id="docx2python-main-module"></span><h2>docx2python.main module<a class="headerlink" href="#module-docx2python.main" title="Permalink to this headline">¶</a></h2>
<p>Top-level code (and some other)</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>7/2/2019</p>
</dd>
</dl>
<p>Some private methods are here because I wanted to keep them with their tests.</p>
<dl class="function">
<dt id="docx2python.main.docx2python">
<code class="sig-prename descclassname">docx2python.main.</code><code class="sig-name descname">docx2python</code><span class="sig-paren">(</span><em class="sig-param">docx_filename: str</em>, <em class="sig-param">image_folder: Optional[str] = None</em>, <em class="sig-param">html: bool = False</em><span class="sig-paren">)</span> &#x2192; docx2python.docx_output.DocxContent<a class="headerlink" href="#docx2python.main.docx2python" title="Permalink to this definition">¶</a></dt>
<dd><p>Unzip a docx file and extract contents.</p>
</dd></dl>

</div>
<div class="section" id="module-docx2python.namespace">
<span id="docx2python-namespace-module"></span><h2>docx2python.namespace module<a class="headerlink" href="#module-docx2python.namespace" title="Permalink to this headline">¶</a></h2>
<p>Register namespace entries in xml <code class="docutils literal notranslate"><span class="pre">document</span></code> elements.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>7/5/2019</p>
</dd>
</dl>
<p>A <code class="docutils literal notranslate"><span class="pre">&lt;w:document&gt;</span></code> element at the top of each xml file defines a namespace:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">document</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">r</span><span class="o">=</span><span class="s2">&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships&quot;</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">w</span><span class="o">=</span><span class="s2">&quot;http://schemas.openxmlformats.org/wordprocessingml/2006/main&quot;</span>
<span class="o">&gt;</span>
</pre></div>
</div>
<p>These entries can be accessed in the file by their abbreviations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">p</span><span class="o">&gt;</span>
    <span class="n">contents</span> <span class="n">of</span> <span class="n">paragraph</span>
<span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">p</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">xml.etree</span></code> in the Python standard docx2python reads <code class="docutils literal notranslate"><span class="pre">&quot;&lt;w:p&gt;&quot;</span></code> as</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;{http://schemas.openxmlformats.org/wordprocessingml/2006/main}p&quot;</span></code></p>
<p>This module defines the necessary namespaces and transforms <code class="docutils literal notranslate"><span class="pre">&quot;w:p&quot;</span></code> to
<code class="docutils literal notranslate"><span class="pre">{http://...}p</span></code>. This allows readable code like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">qn</span><span class="p">(</span><span class="s2">&quot;w:p&quot;</span><span class="p">):</span>
</pre></div>
</div>
<p>instead of:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;{http://schemas.openxmlformats.org/wordprocessingml/2006/main}p&quot;</span><span class="p">:</span>
</pre></div>
</div>
<p>If somewhere along the line this package just stops working, it may be that the NSMAP
entries have been updated for whatever docx you’re working with (though that’s not
supposed to ever happen). <em>If</em> this happens:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1) Unzip the docx.
2) open ``word/document.xml`` in a text editor.
3) Search for xmlns:w=[some string]
4) update NSMAP[&#39;w&#39;] = some string
</pre></div>
</div>
<dl class="function">
<dt id="docx2python.namespace.qn">
<code class="sig-prename descclassname">docx2python.namespace.</code><code class="sig-name descname">qn</code><span class="sig-paren">(</span><em class="sig-param">tag: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.namespace.qn" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a namespace-prefixed tag into a Clark-notation qualified tag.</p>
<p>Stands for ‘qualified name’, a utility function to turn a namespace prefixed tag
name into a Clark-notation qualified tag name for lxml.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qn</span><span class="p">(</span><span class="s1">&#39;w:cSld&#39;</span><span class="p">)</span>
<span class="go">&#39;{http://schemas.../main}cSld&#39;</span>
</pre></div>
</div>
<p>Source: <a class="reference external" href="https://github.com/python-openxml/python-docx/">https://github.com/python-openxml/python-docx/</a></p>
</dd></dl>

</div>
<div class="section" id="module-docx2python.numbering_formats">
<span id="docx2python-numbering-formats-module"></span><h2>docx2python.numbering_formats module<a class="headerlink" href="#module-docx2python.numbering_formats" title="Permalink to this headline">¶</a></h2>
<p>Numbering formats for converted XML lists.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>6/26/2019</p>
</dd>
</dl>
<p>I don’t want to add non-ascii text to a potentially ascii-only file, so all bullets
are ‘–’ and Roman numerals stop at 3999.</p>
<p>Doesn’t capture formatting like 1.1.1 or b) or (ii). Only the six basic formats are
covered:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">bullet</span>
<span class="mi">1</span>  <span class="n">decimal</span>
<span class="n">a</span>  <span class="n">lowerLetter</span>
<span class="n">A</span>  <span class="n">upperLetter</span>
<span class="n">i</span>  <span class="n">lowerRoman</span>
<span class="n">I</span>  <span class="n">upperRoman</span>
</pre></div>
</div>
<dl class="function">
<dt id="docx2python.numbering_formats.bullet">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">bullet</code><span class="sig-paren">(</span><em class="sig-param">_: int = 0</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.bullet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="docx2python.numbering_formats.decimal">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">decimal</code><span class="sig-paren">(</span><em class="sig-param">n: int</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.decimal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="docx2python.numbering_formats.lower_letter">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">lower_letter</code><span class="sig-paren">(</span><em class="sig-param">n: int</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.lower_letter" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a positive integer to a string of letters representing base 26.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> – any positive integer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>the kind of “numbering” used for numbered lists and excel columns.
(a, b, c … aa, ab …) Zero is undefined.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lower_letter</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_letter</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<span class="go">&#39;z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_letter</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="go">&#39;aa&#39;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="docx2python.numbering_formats.lower_roman">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">lower_roman</code><span class="sig-paren">(</span><em class="sig-param">n: int</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.lower_roman" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a positive integer to a lowercase Roman numeral</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> – any positive integer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Roman number equivalent of n</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lower_roman</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;i&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_roman</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">&#39;ix&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lower_roman</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="go">&#39;xliv&#39;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>Numbers greater than 3999 can be expressed with a bar over the number. The bar
means “times 1000” (e.g., iv with a bar over it would be 4000).</p>
<p>It’ll never happen in this project, and I don’t want to add non-ascii to what
might be a pure ascii file, so this function will keep adding ‘m’ to as many
thousand as you’d like.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lower_roman</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="go">&#39;mmmmmmmmmm&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.numbering_formats.upper_letter">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">upper_letter</code><span class="sig-paren">(</span><em class="sig-param">n: int</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.upper_letter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="docx2python.numbering_formats.upper_roman">
<code class="sig-prename descclassname">docx2python.numbering_formats.</code><code class="sig-name descname">upper_roman</code><span class="sig-paren">(</span><em class="sig-param">n: int</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.numbering_formats.upper_roman" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-docx2python.text_runs">
<span id="docx2python-text-runs-module"></span><h2>docx2python.text_runs module<a class="headerlink" href="#module-docx2python.text_runs" title="Permalink to this headline">¶</a></h2>
<p>Get text run formatting.</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Shay Hill</p>
</dd>
<dt class="field-even">created</dt>
<dd class="field-even"><p>7/4/2019</p>
</dd>
</dl>
<p>Text runs are formatted inline in the <code class="docutils literal notranslate"><span class="pre">trash/document.xml</span></code> or header files. Read
those elements to extract formatting information.</p>
<dl class="function">
<dt id="docx2python.text_runs.gather_rPr">
<code class="sig-prename descclassname">docx2python.text_runs.</code><code class="sig-name descname">gather_rPr</code><span class="sig-paren">(</span><em class="sig-param">run_element: xml.etree.ElementTree.Element</em><span class="sig-paren">)</span> &#x2192; Dict[str, Optional[str]]<a class="headerlink" href="#docx2python.text_runs.gather_rPr" title="Permalink to this definition">¶</a></dt>
<dd><p>Gather formatting elements for a text run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_element</strong> – a <code class="docutils literal notranslate"><span class="pre">&lt;w:r&gt;</span></code> xml element</p>
</dd>
</dl>
<p>create with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">document</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;bytes string&#39;</span><span class="p">)</span>
<span class="c1"># recursively search document for &lt;w:r&gt; elements.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Style names (‘b/’, ‘sz’, etc.) mapped to values.</p>
</dd>
</dl>
<p>To keep things more homogeneous, I’ve given tags list b/ (bold) a value of None,
even though they don’t take a value in xml.</p>
<p>Each element of rPr will be either present (returned tag: None) or have a value
(returned tag: val).</p>
<p><strong>E.g., given</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">r</span> <span class="n">w</span><span class="p">:</span><span class="n">rsidRPr</span><span class="o">=</span><span class="s2">&quot;000E1B98&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">rPr</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">rFonts</span> <span class="n">w</span><span class="p">:</span><span class="n">ascii</span><span class="o">=</span><span class="s2">&quot;Arial&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">b</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">sz</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">szCs</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">u</span> <span class="n">w</span><span class="p">:</span><span class="n">val</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">rPr</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">w</span><span class="p">:</span><span class="n">t</span><span class="o">&gt;</span><span class="n">text</span> <span class="n">styled</span>  <span class="k">with</span> <span class="n">rPr</span>
    <span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">t</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">w</span><span class="p">:</span><span class="n">r</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>E.g., returns</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;rFonts&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;u&quot;</span><span class="p">:</span> <span class="s2">&quot;single&quot;</span><span class="p">,</span>
    <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;sz&quot;</span><span class="p">:</span> <span class="s2">&quot;32&quot;</span><span class="p">,</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="s2">&quot;szCs&quot;</span><span class="p">:</span> <span class="s2">&quot;32&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.text_runs.get_run_style">
<code class="sig-prename descclassname">docx2python.text_runs.</code><code class="sig-name descname">get_run_style</code><span class="sig-paren">(</span><em class="sig-param">run_element: xml.etree.ElementTree.Element</em><span class="sig-paren">)</span> &#x2192; List[Tuple[str, str]]<a class="headerlink" href="#docx2python.text_runs.get_run_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Select only rPr2 tags you’d like to implement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_element</strong> – a <code class="docutils literal notranslate"><span class="pre">&lt;w:r&gt;</span></code> xml element</p>
</dd>
</dl>
<p>create with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">document</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;bytes string&#39;</span><span class="p">)</span>
<span class="c1"># recursively search document for &lt;w:r&gt; elements.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[(rPr,</span> <span class="pre">val),</span> <span class="pre">(rPr,</span> <span class="pre">val)</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
<p>Tuples are always returned in order:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;font&quot;</span></code> first then any other styles in alphabetical order.</p>
<p>Also see docstring for <code class="docutils literal notranslate"><span class="pre">gather_rPr</span></code></p>
</dd></dl>

<dl class="function">
<dt id="docx2python.text_runs.style_close">
<code class="sig-prename descclassname">docx2python.text_runs.</code><code class="sig-name descname">style_close</code><span class="sig-paren">(</span><em class="sig-param">style: List[Tuple[str, str]]</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.text_runs.style_close" title="Permalink to this definition">¶</a></dt>
<dd><p>HTML tags to close a style.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="s1">&#39;color=&quot;red&quot; size=&quot;32&quot;&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style_close</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
<span class="go">&#39;&lt;/u&gt;&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&#39;</span>
</pre></div>
</div>
<p>Tags will always be in reverse (of open) order, so open - close will look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">b</span><span class="o">&gt;&lt;</span><span class="n">i</span><span class="o">&gt;&lt;</span><span class="n">u</span><span class="o">&gt;</span><span class="n">text</span><span class="o">&lt;/</span><span class="n">u</span><span class="o">&gt;&lt;/</span><span class="n">i</span><span class="o">&gt;&lt;/</span><span class="n">b</span><span class="o">&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="docx2python.text_runs.style_open">
<code class="sig-prename descclassname">docx2python.text_runs.</code><code class="sig-name descname">style_open</code><span class="sig-paren">(</span><em class="sig-param">style: Sequence[Tuple[str, str]]</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#docx2python.text_runs.style_open" title="Permalink to this definition">¶</a></dt>
<dd><p>HTML tags to open a style.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">style</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="s1">&#39;color=&quot;red&quot; size=&quot;32&quot;&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">style_open</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
<span class="go">&#39;&lt;font color=&quot;red&quot; size=&quot;32&quot;&gt;&lt;b&gt;&lt;i&gt;&lt;u&gt;&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-docx2python">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-docx2python" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Shay Hill

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>